{% extends 'base.html' %}
{% load static %}
{% block title %} | Cart{% endblock %}
{% block content %}

<div class="my-form container p-5 my-5 rounded border border-warning">
    <h2 class="text-center">Cart</h2>
    <hr>
    {% if not request.user.is_authenticated or request.user.is_anonymous%}
    <h5 class="alert alert-warning">You must <a href="{% url 'signin' %}" class="text-dark">Log In</a></h5>
    {% elif order %}
    <h5>
        full name: <span class="my-num">{{user.first_name |add:' ' |add:user.last_name}}</span>

        <a href="{% url 'products' %}" class="btn btn-outline-secondary float-right m-1">
          Continue shopping
        </a>
       
        <a href="{% url 'payment' %}" class="btn btn-outline-secondary float-right m-1">
          Check Out
        </a>
        <hr>
        order number: <span class="my-num">{{order.id}}</span>  
        <hr>
        total: <span class="my-num">{{total}}$</span>
        <hr>
        for <span class="my-num">{{orderdetails.count}} products</span>
    </h5>
    <table class="table table-hover">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">Product</th>
            <th scope="col">Image</th>
            <th scope="col">Quantity</th>
            <th scope="col">price</th>
            <th scope="col">Subtotal</th>
            <th scope="col">Control</th>
          </tr>
        </thead>
        <tbody>
            {% for line in orderdetails %}
            <tr>
              <th scope="row">{{forloop.counter}}</th>
              <td>{{line.product.name}}</td>
              <td><img src="{{line.product.photo.url}}" style="width: 80px; height:80px;" alt=""> </td>
              <td>
                <a href="{% url 'sub_qty' orderdetails_id=line.id %}" class="btn btn-outline-warning btn-sm">-</a>
                {{line.quantity}}
                <a href="{% url 'add_qty' orderdetails_id=line.id %}" class="btn btn-outline-warning btn-sm">+</a>
                
              </td>
              <td>{{line.price}}$</td>
              <td style="font-weight:bold;color:darkred;">{% widthratio line.quantity  1  line.price %}$</td>
              <td>
                <a class="btn btn-outline-danger btn-sm" href="{% url 'remove_from_cart' orderdetails_id=line.id %}">Remove</a>
              </td>
            </tr>
            {% empty %}
            <h5 class="alert alert-warning">
                No Orders Here</h5>

            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <h4 class="alert alert-warning">
        No Orders Here
         <a href="{% url 'products' %}" class="text-dark">All products</a>

    </h4>
    {% endif %}



</div>


{% endblock %}